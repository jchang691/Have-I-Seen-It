<% if !@user.nil? %>
    <ul class="nav nav-tabs" id="movieTab">
        <li><a href="#user_library" data-toggle="tab">User Library</a><li>
        <li><a href="#all_library" data-toggle="tab">All</a><li>
    </ul>

    <div class="tab-content">
        <div class="tab-pane" id="user_library">
            <div class="pull-right">
                Movies Per Page: 
                <%= link_to "10", movies_per_page_users_path(:per_page => 10) %>
                <%= link_to "15", movies_per_page_users_path(:per_page => 15) %>
                <%= link_to "20", movies_per_page_users_path(:per_page => 20) %>
            </div>
            <h3>Your Library</h3>
            <ul class="users">
              <%= render @movies %>
            </ul>
            <%= will_paginate @movies%>
            <br>
            <%= link_to "Add a Movie", new_movie_path, class: "btn "%>
        </div>

        <div class="tab-pane" id="all_library">
            <div class="pull-right">
                Movies Per Page: 
                <%= link_to "10", movies_per_page_users_path(:per_page => 10) %>
                <%= link_to "15", movies_per_page_users_path(:per_page => 15) %>
                <%= link_to "20", movies_per_page_users_path(:per_page => 20) %>
            </div>
            <h3>All Movies</h3>
            <ul class="users">
              <%= render @all_movies %>
            </ul>
            <%= will_paginate @all_movies %>
        </div>
    </div>
<% else %>
    <div class="center hero-unit">
        <h2>
            Welcome to Have I Seen It!
        </h2>
        <%= link_to "Sign-Up Now!", signup_path, class: "btn btn-large btn-primary" %>
    </div>
<% end %>

<script type="text/javascript">
    $(document).ready(function() {

        $('#movieTab a[data-toggle="tab"]').on('shown', function (e) {
            //save the latest tab; use cookies if you like 'em better:
            localStorage.setItem('lastTab', $(e.target).attr('href'));
        });

        //go to the latest tab, if it exists:
        var lastTab = localStorage.getItem('lastTab');
        if (lastTab != "undefined") {
          $('ul.nav-tabs').children().removeClass('active');
          $('a[href='+ lastTab +']').parents('li:first').addClass('active');
          $('div.tab-content').children().removeClass('active');
          $(lastTab).addClass('active');
        }
    });

</script>
